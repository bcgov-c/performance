<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;
use Illuminate\Support\Facades\DB;

class UpdateConversationRoleNew6 extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        $conversations = array();
        $mgr_participants = array();
        $emp_participants = array();
        
        
        $conversation_list = '4,5,6,7,8,9,10,13,17,26,27,28,29,47,55,58,65,78,81,85,86,92,93,95,105,128,140,141,143,145,157,158,162,166,169,170,176,185,212,214,255,266,267,296,347,357,366,367,368,369,370,413,416,424,426,507,514,517,525,533,541,545,575,598,600,602,603,604,607,608,609,610,612,663,685,705,723,724,725,727,741,820,892,893,925,926,981,999,1084,1085,1086,1088,1116,1142,1182,1208,1219,1286,1287,1291,1411,1414,1480,1487,1489,1499,1628,1758,1781,1836,1877,2020,2039,2040,2042,2107,2205,2207,2213,2269,2368,2387,2510,2612,2663,2694,2715,2718,2746';
        $mgr_list = '21920,11763,35043,31639,13867,23890,30825,29476,31004,15693,26268,23781,32879,11961,16651,36282,13728,39482,21988,30475,44315,24194,20696,13797,29081,26903,11969,37658,13743,22647,39460,11387,10550,35793,12316,17006,29508,36399,10625,17950,19496,28122,16616,15510,10147,23961,29878,20220,43933,24244,19153,14605,40351,32885,23216,25454,23237,15541,22938';
        $emp_list = '31354,33591,34550,38883,38888,38892,33486,25473,13619,11104,28101,21170,16504,39843,35022,30679,21582,26401,31312,13384,30286,37653,45624,48903,38516,19034,16623,35015,44245,42407,42545,34963,47696,17103,17829,19390,30382,24930,25331,30144,20926,23750,42223,15206,37927,42624,13854,40206,38373,44548,37481,35097,29267,37439,41164,41317,43320,45841,45842,47644,39666,38313,42161,21300,10008,31113,37357,16453,11969,35203,24570,14638,38590,19921,38496,45279,25156,40351,32935,24701,30338,39766,17950,37171,43256,31020,43516,15567,47892,27687,31481,38340,40566,42549,46538,25236,11816,50169,30367,43467,39866,48798';
        
        $conversations = explode(',', $conversation_list);
        $mgr_participants = explode(',', $mgr_list);
        $emp_participants = explode(',', $emp_list);
        
        //update mgr role
        DB::table('conversation_participants')
                                ->WhereIn('conversation_id', $conversations) 
                                ->WhereIn('participant_id', $mgr_participants) 
                                ->update(array('role' => 'mgr')); 
        
        //update emp role
        DB::table('conversation_participants')
                                ->WhereIn('conversation_id', $conversations) 
                                ->WhereIn('participant_id', $emp_participants) 
                                ->update(array('role' => 'emp')); 
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        //
    }
}
